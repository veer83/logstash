---
- name: Download Logstash Package
  get_url:
    url: "https://artifacts.elastic.co/downloads/logstash/logstash-{{ logstash_version }}-x86_64.rpm"
    dest: "/var/tmp"

- name: Check if Logstash is installed
  stat:
    path: "{{ logstash_install_dir }}/bin/logstash"
  register: logstash_installed

- name: Install or upgrade Logstash
  yum:
    name: "/var/tmp/logstash-{{ logstash_version }}-x86_64.rpm"
    state: "{{ 'latest' if logstash_installed.stat.exists and logstash_version != logstash_installed.stat.size else 'present' }}"
    disable_gpg_check: yes

  

  